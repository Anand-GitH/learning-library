{"paragraphs":[{"text":"%md\n![MovieStream Logo](https://oracle.github.io/learning-library/data-management-library/autonomous-database/shared/movie-stream-story/introduction/images/moviestream.jpeg)","user":"MOVIESTREAM","dateUpdated":"2021-10-22T13:22:35+0000","config":{"colWidth":7,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":362.95,"optionOpen":false}}},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><img src=\"https://oracle.github.io/learning-library/data-management-library/autonomous-database/shared/movie-stream-story/introduction/images/moviestream.jpeg\" alt=\"MovieStream Logo\" /></p>\n"}]},"interrupted":false,"jobName":"paragraph_1634924806093_1701815071","id":"20211022-174646_1402574205","dateCreated":"2021-09-20T17:49:43+0000","dateStarted":"2021-10-22T13:22:36+0000","dateFinished":"2021-10-22T13:22:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":false,"focus":true,"$$hashKey":"object:40"},{"text":"%md\n## MovieStream Discovery\n* Who is using the service?  And, what types of movies are they purchasing?\n* Can we expect a lift from the Academy Awards?\n* Can we better understand at-risk customers?  Who are they?  \n\n### Seemingly simple questions - and they can be if you have <span style=\"color: red;\">the right database and query engine</span>\n#### <span style=\"color: blue;\">Avoid falling off the complexity cliff</span> with <span style=\"color: red;\">Autonomous Database and Oracle SQL</span>\nData is stored across storage tiers and in multiple formats.  Autonomous Database is a converged database that allows a single table to capture data of different types (scalar, json, geocoded and more) - stored both in the database as well as in object storage.  Combine 1) ADB's ability to shield users and applications from storage complexity and 2) the market's leading SQL capabilities - and you can get fast answers to tough questions from any application.","user":"MOVIESTREAM","dateUpdated":"2021-10-22T13:22:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>MovieStream Discovery</h2>\n<ul>\n<li>Who is using the service?  And, what types of movies are they purchasing?</li>\n<li>Can we expect a lift from the Academy Awards?</li>\n<li>Can we better understand at-risk customers?  Who are they?</li>\n</ul>\n<h3>Seemingly simple questions - and they can be if you have <span style=\"color: red;\">the right database and query engine</span></h3>\n<h4><span style=\"color: blue;\">Avoid falling off the complexity cliff</span> with <span style=\"color: red;\">Autonomous Database and Oracle SQL</span></h4>\n<p>Data is stored across storage tiers and in multiple formats.  Autonomous Database is a converged database that allows a single table to capture data of different types (scalar, json, geocoded and more) - stored both in the database as well as in object storage.  Combine 1) ADB's ability to shield users and applications from storage complexity and 2) the market's leading SQL capabilities - and you can get fast answers to tough questions from any application.</p>\n"}]},"interrupted":false,"jobName":"paragraph_1634924806093_-57695966","id":"20211022-174646_2116625396","dateCreated":"2021-04-13T14:47:43+0000","dateStarted":"2021-10-22T13:22:42+0000","dateFinished":"2021-10-22T13:22:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:41"},{"text":"%md\n## <span style=\"color: blue;\">Let's take a look at sales data from our data warehouse</span>\nWe have contact information about all of our customers and can see sales by geography","user":"MOVIESTREAM","dateUpdated":"2021-10-22T13:22:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2><span style=\"color: blue;\">Let's take a look at sales data from our data warehouse</span></h2>\n<p>We have contact information about all of our customers and can see sales by geography</p>\n"}]},"interrupted":false,"jobName":"paragraph_1634924806093_915930022","id":"20211022-174646_232728476","dateCreated":"2021-09-17T19:26:28+0000","dateStarted":"2021-10-22T13:22:49+0000","dateFinished":"2021-10-22T13:22:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:42"},{"title":"Top Sales by City","text":"%sql\nselect c.city, round(sum(actual_price)) as sales\nfrom customer_contact c, custsales s\nwhere c.cust_id = s.cust_id\nand c.country = 'United States'\ngroup by c.city\norder by 2 desc\nfetch first 10 rows only;","user":"MOVIESTREAM","dateUpdated":"2021-10-22T13:22:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"CITY":"string","SALES":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate","stacked":false}},"commonSetting":{},"keys":[{"name":"CITY","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"SALES","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","editorHide":true,"title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_-1671177621","id":"20211022-174646_1069742644","dateCreated":"2021-09-11T14:38:23+0000","dateStarted":"2021-10-21T19:42:39+0000","dateFinished":"2021-10-21T19:42:45+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:43"},{"title":"Customer Contact Information in Warehouse","text":"%sql\nselect * from customer_contact where rownum < 10;","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:23:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"CUST_ID","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"LAST_NAME","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"FIRST_NAME","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"EMAIL","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"STREET_ADDRESS","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"POSTAL_CODE","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"CITY","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"STATE_PROVINCE","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"COUNTRY","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"COUNTRY_CODE","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"CONTINENT","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"YRS_CUSTOMER","visible":true,"width":"*","sort":{"priority":0,"direction":"asc"},"filters":[{}],"pinned":""},{"name":"PROMOTION_RESPONSE","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"LOC_LAT","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"LOC_LONG","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"CUST_ID":"string","LAST_NAME":"string","FIRST_NAME":"string","EMAIL":"string","STREET_ADDRESS":"string","POSTAL_CODE":"string","CITY":"string","STATE_PROVINCE":"string","COUNTRY":"string","COUNTRY_CODE":"string","CONTINENT":"string","YRS_CUSTOMER":"string","PROMOTION_RESPONSE":"string","LOC_LAT":"string","LOC_LONG":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","title":true,"editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_2019428556","id":"20211022-174646_544187084","dateCreated":"2021-09-11T14:40:29+0000","dateStarted":"2021-10-21T14:23:06+0000","dateFinished":"2021-10-21T14:23:12+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:44"},{"text":"%md\n## <span style=\"color: blue;\">How to better understand customer profiles</span>\n### Lake House Queries\nWhat data do we have in our lake house that would help us understand our customers?\n\n<span style=\"color: red;\">**Go to [Data Catalog](https://console.us-phoenix-1.oraclecloud.com/datacatalog) to find interesting data.**</span>\n\nIn our Data Lake, we have information about customer in the Landing Zone that has not yet been certified - but is still useful for analysis.\nLet's explore <span style=\"color: blue;\">**customer demographic**</span> and <span style=\"color: blue;\">**customer segmentation**</<span> data sets.","user":"MOVIESTREAM","dateUpdated":"2021-10-22T17:47:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":true,"title":false},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_196521087","id":"20211022-174646_393089974","dateCreated":"2021-09-13T20:05:40+0000","dateStarted":"2021-09-30T17:05:31+0000","dateFinished":"2021-09-30T17:05:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:45"},{"text":"%sql\n-- Make this a little easier to view the mappping\nselect a.folder_name, \n       a.display_name, \n       d.oracle_schema_name, \n       d.oracle_table_name\nfrom all_dcat_entities a, dcat_entities d\nwhere a.data_asset_key = d.asset_key\nand a.key = d.entity_key\norder by 1,2;","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"FOLDER_NAME":"string","DISPLAY_NAME":"string","ORACLE_SCHEMA_NAME":"string","ORACLE_TABLE_NAME":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_250036546","id":"20211022-174646_1668887808","dateCreated":"2021-09-20T20:33:25+0000","dateStarted":"2021-09-30T17:07:08+0000","dateFinished":"2021-09-30T17:07:08+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:46"},{"title":"Customer Segmentation","text":"%sql\nselect short_name, 1 as id \nfrom dcat$obj_landing.customer_segment cs\n;","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"SHORT_NAME":"string","ID":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"pieChart":{}},"commonSetting":{},"keys":[{"name":"SHORT_NAME","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"ID","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","title":true,"editorHide":true,"lineNumbers":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_-1934665115","id":"20211022-174646_1271029761","dateCreated":"2021-09-17T19:51:25+0000","dateStarted":"2021-09-30T17:05:35+0000","dateFinished":"2021-09-30T17:05:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:47"},{"title":"Customer Demographics","text":"%sql\nselect * \nfrom dcat$obj_landing.customer_extension ce\nwhere rownum < 100;","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":8,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"CUST_ID":"string","LAST_NAME":"string","FIRST_NAME":"string","EMAIL":"string","AGE":"string","COMMUTE_DISTANCE":"string","CREDIT_BALANCE":"string","EDUCATION":"string","FULL_TIME":"string","GENDER":"string","HOUSEHOLD_SIZE":"string","INCOME":"string","INCOME_LEVEL":"string","INSUFF_FUNDS_INCIDENTS":"string","JOB_TYPE":"string","LATE_MORT_RENT_PMTS":"string","MARITAL_STATUS":"string","MORTGAGE_AMT":"string","NUM_CARS":"string","NUM_MORTGAGES":"string","PET":"string","RENT_OWN":"string","SEGMENT_ID":"string","WORK_EXPERIENCE":"string","YRS_CURRENT_EMPLOYER":"string","YRS_RESIDENCE":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","editorHide":true,"title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_445641846","id":"20211022-174646_384225911","dateCreated":"2021-09-13T20:11:33+0000","dateStarted":"2021-09-30T17:05:37+0000","dateFinished":"2021-09-30T17:05:38+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:48"},{"title":"Let's combine the data in the Warehouse with information from the Data Lake","text":"%sql\n-- Notice that joining data from the lake with the warehouse is transparent to the user/application\nselect cs.short_name as segment,\n       ce.first_name || ' ' || ce.last_name as full_name,\n\t   cc.state_province,\n       cc.country,\n       ce.age,\n       ce.gender,\n       ce.marital_status,\n       ce.job_type,\n       ce.household_size\nfrom moviestream.customer_contact cc, \n     dcat$obj_landing.customer_segment cs, \n     dcat$obj_landing.customer_extension ce\nwhere ce.segment_id = cs.segment_id\n  and ce.cust_id = cc.cust_id\n  and rownum < 100;","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"SEGMENT":"string","FULL_NAME":"string","STATE_PROVINCE":"string","COUNTRY":"string","AGE":"string","GENDER":"string","MARITAL_STATUS":"string","JOB_TYPE":"string","HOUSEHOLD_SIZE":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","title":true,"editorHide":true,"lineNumbers":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_-1404892310","id":"20211022-174646_1903329470","dateCreated":"2021-09-17T19:52:15+0000","dateStarted":"2021-09-30T17:05:39+0000","dateFinished":"2021-09-30T17:05:41+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:49"},{"title":"A high level look at our customer movie preferences   ---->  same query across any data source","text":"%sql\n\n-- Simple query to find out who (customer segment) is buying different types of movies (genres).\n-- Here, data is in the database.  But the data for these tables could also be stored in object store (or both).\n-- It's transparent to the application.\nselect cs.short_name as segment,\n       g.name as genre,\n\t   trunc(sum(s.actual_price),0) as sales\nfrom  dcat$obj_landing.customer_extension ce, \n      dcat$obj_landing.customer_segment cs, \n      moviestream.genre g, \n      moviestream.custsales s\nwhere ce.segment_id = cs.segment_id\n  and s.genre_id = g.genre_id\n  and ce.cust_id = s.cust_id\ngroup by cs.short_name, g.name\norder by 1, 2;","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/osql","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":464.006,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"SEGMENT":"string","GENRE":"string","SALES":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":true},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"SEGMENT","index":0,"aggr":"sum"}],"groups":[{"name":"GENRE","index":1,"aggr":"sum"}],"values":[{"name":"SALES","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorHide":true,"title":true,"lineNumbers":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_762005786","id":"20211022-174646_1535732389","dateCreated":"2021-04-13T14:24:15+0000","dateStarted":"2021-09-30T17:05:42+0000","dateFinished":"2021-09-30T17:05:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:50"},{"title":"What important customers are at risk?  Analyze using Recency, Frequency and Monetary trends","text":"%sql\n-- Use RFM - Recency, Frequency and Monetary analysis to categorize customer behavior.   Any big spenders that are not active?\n-- Look for customers in a High Spend quintile and Low Recency quintile \nwith rfm as (\n    SELECT cs.cust_id,\n         c.last_name,\n         c.first_name,\n         c.gender,\n         c.age,\n         c.income_level,\n         NTILE (5) over (order by sum(cs.actual_price)) AS rfm_monetary,\n         NTILE (5) over (order by max(cs.day_id)) AS rfm_recency,\n         NTILE (5) over (order by count(1))    AS rfm_frequency\n    FROM moviestream.custsales cs, dcat$obj_landing.customer_extension c\n    WHERE c.cust_id = cs.cust_id\n    GROUP BY cs.cust_id,         \n         c.last_name,\n         c.first_name,\n         c.gender,\n         c.age,\n         c.income_level\n)\nselect *\nfrom rfm\nwhere \n    rfm_monetary >= 4\nand rfm_recency <= 2\norder by rfm_monetary desc, rfm_recency asc\nfetch first 200 rows only;","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":384.006,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"CUST_ID":"string","LAST_NAME":"string","FIRST_NAME":"string","GENDER":"string","AGE":"string","INCOME_LEVEL":"string","RFM_MONETARY":"string","RFM_RECENCY":"string","RFM_FREQUENCY":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[],"groups":[],"values":[]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","title":true,"editorHide":true,"lineNumbers":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_-1154733208","id":"20211022-174646_51628989","dateCreated":"2021-04-14T16:38:31+0000","dateStarted":"2021-09-30T17:05:50+0000","dateFinished":"2021-09-30T17:06:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:51"},{"text":"%md\n## <span style=\"color: blue;\">How do the Academy Awards impact sales?</span>\n### Use advanced SQL over JSON sources","user":"MOVIESTREAM","dateUpdated":"2021-10-22T13:23:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2><span style=\"color: blue;\">How do the Academy Awards impact sales?</span></h2>\n<h3>Use advanced SQL over JSON sources</h3>\n"}]},"interrupted":false,"jobName":"paragraph_1634924806093_-1506997031","id":"20211022-174646_591844546","dateCreated":"2021-09-20T19:20:58+0000","dateStarted":"2021-10-22T13:23:07+0000","dateFinished":"2021-10-22T13:23:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:52"},{"title":"Simple queries over JSON","text":"%sql\n-- What about movie?\n-- There are also complex file types - like movie which is defined over JSON\n-- Let's look at award winning movies\nselect m.json_document,\n       m.json_document.movie_id,\n       m.json_document.title,\n       m.json_document.genre,\n       m.json_document.views,\n       m.json_document.awards,\n       decode(m.json_document.awards, null, null, json_value(m.json_document,'$.awards.size()')) num_awards,\n       m.json_document.nominations,\n       decode (m.json_document.nominations, null, null, json_value(m.json_document,'$.nominations.size()')) num_nominations\nfrom dcat$obj_gold.movie m \nwhere m.json_document.awards is not null;","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"JSON_DOCUMENT","visible":true,"width":670,"sort":{},"filters":[{}],"pinned":""},{"name":"MOVIE_ID","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"TITLE","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"GENRE","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"VIEWS","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"AWARDS","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"NUM_AWARDS","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"NOMINATIONS","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"NUM_NOMINATIONS","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"JSON_DOCUMENT":"string","MOVIE_ID":"string","TITLE":"string","GENRE":"string","VIEWS":"string","AWARDS":"string","NUM_AWARDS":"string","NOMINATIONS":"string","NUM_NOMINATIONS":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","editorHide":true,"title":true,"lineNumbers":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_588302584","id":"20211022-174646_1188353892","dateCreated":"2021-09-20T19:30:44+0000","dateStarted":"2021-09-30T17:06:08+0000","dateFinished":"2021-09-30T17:06:09+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:53"},{"title":"JSON is flexible - but can be tricky to use.  Analyzing complex fields ","text":"%sql\n-- A movie may receive multiple awards - awards is a JSON array\n-- Other fields are similar - like crew and cast\nselect title, awards\nfrom movie   \nwhere awards is not null\norder by title","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":421.989,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"TITLE":"string","AWARDS":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","editorHide":true,"title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_-1261275207","id":"20211022-174646_1444434265","dateCreated":"2021-04-13T14:29:12+0000","dateStarted":"2021-09-30T17:06:13+0000","dateFinished":"2021-09-30T17:06:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:54"},{"title":"Oracle SQL makes JSON look familiar ---->  use powerful json transforms","text":"-- JSON_TABLE is a powerful function that will perform a lateral join - creating a row for each award for movies\n-- Awards are now easily queried\nselect title, award    \nfrom movie, JSON_TABLE(awards, '$[*]' columns (award path '$')) jt\nwhere awards is not null\norder by title","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":424.006,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"TITLE":"string","AWARD":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","title":true,"editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_-381014807","id":"20211022-174646_1271604740","dateCreated":"2021-04-14T17:06:41+0000","dateStarted":"2021-09-30T17:06:16+0000","dateFinished":"2021-09-30T17:06:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:55"},{"title":"Drop movie table (in case you run this notebook twice)","text":"%sql\n-- Make sure the movie table doesn't exist prior to trying to create it in the next paragraph\ndrop table movie;","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","title":true,"editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_142478392","id":"20211022-174646_1581124475","dateCreated":"2021-09-29T23:32:52+0000","dateStarted":"2021-09-30T17:06:20+0000","dateFinished":"2021-09-30T17:06:20+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:56"},{"title":"Easily import JSON data into Autonomous Database","text":"%sql\n-- Movies are in the Gold Zone and we'll be querying them frequently.  \n-- Let's store this data in the database.\ncreate table movie as\n    select\n        json_value(m.json_document,'$.movie_id' returning number) as movie_id,\n        m.json_document.title as title,   \n        json_value(m.json_document,'$.budget' returning number) as budget,\n        json_value(m.json_document,'$.gross' returning number) gross,\n        json_value(m.json_document,'$.list_price' returning number) as list_price,\n        m.json_document.genre as genres,\n        m.json_document.sku as sku,   \n        json_value(m.json_document,'$.year' returning number) as year,\n        to_date(m.json_document.opening_date, 'YYYY-MM-DD') as opening_date,\n        json_value(m.json_document,'$.views' returning number) as views,\n        m.json_document.cast as cast,\n        m.json_document.crew as crew,\n        m.json_document.studio as studio,\n        m.json_document.main_subject as main_subject,\n        m.json_document.awards as awards,\n        decode (m.json_document.awards, null, null, json_value(m.json_document,'$.awards.size()')) num_awards,\n        m.json_document.nominations as nominations,\n        decode (m.json_document.nominations, null, null, json_value(m.json_document,'$.nominations.size()')) num_nominations,        \n        json_value(m.json_document,'$.runtime' returning number) as runtime\n    from dcat$obj_gold.movie m;\n    \n\n","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","title":true,"lineNumbers":true,"editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_-383121080","id":"20211022-174646_1043437615","dateCreated":"2021-09-20T20:08:51+0000","dateStarted":"2021-09-30T17:06:24+0000","dateFinished":"2021-09-30T17:06:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:57"},{"title":"Confirm the JSON fields","text":"%script\n\nbegin\n  execute immediate 'alter table movie add constraint m_awards_json check (awards is json strict)';\n  execute immediate 'alter table movie add constraint m_nominations_json check (nominations is json strict)';\n\nend;","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","title":true,"editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_-437944136","id":"20211022-174646_716674089","dateCreated":"2021-09-21T19:12:50+0000","dateStarted":"2021-09-30T17:06:29+0000","dateFinished":"2021-09-30T17:06:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:58"},{"title":"Is there an Academy Award bump?  Let's look at customer interest in previous award winners 2 weeks before and after the event  -----> time-series + multi-model queries","text":"%sql\n\nwith academyAwardedMovies as (\n    select movie_id, title, year, award    \n    from movie, JSON_TABLE(awards, '$[*]' columns (award path '$')) jt\n    where lower(award) like '%academy%'\n    and year > 2000\n),\nacademyMovieSales as (\n   select sales.movie_id, sales.day_id\n   from moviestream.custsales sales, academyAwardedMovies awm\n   where sales.movie_id = awm.movie_id\n),\nbefore2020Award as (\n  select ams1.movie_id, count(1) as before_count\n  from academyMovieSales ams1 where day_id between to_date('09/02/2020', 'DD/MM/YYYY') -14\n                                            and to_date('09/02/2020', 'DD/MM/YYYY')\n  group by ams1.movie_id\n),\nafter2020Award as (\n  select ams2.movie_id, count(1) as after_count\n  from academyMovieSales ams2 where day_id between to_date('09/02/2020', 'DD/MM/YYYY')\n                                            and to_date('09/02/2020', 'DD/MM/YYYY') +14\n  group by ams2.movie_id\n)\nselect distinct\n    awm.title, \n    substr(awm.title, 1, 15) title_label,\n    awm.year, \n    bef.before_count as \"before event\", \n    aft.after_count as \"after event\", \n    round((aft.after_count - bef.before_count)/bef.before_count * 100) as  \"percent change\"\nfrom after2020Award aft, before2020Award bef, academyAwardedMovies awm\nwhere aft.movie_id = bef.movie_id\n  and bef.movie_id = awm.movie_id\norder by \"percent change\" DESC;","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":736.128,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"TITLE":"string","YEAR":"string","BEFORE_COUNT":"string","AFTER_COUNT":"string","Ratio":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate","stacked":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"TITLE","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"percent change","index":5,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","editorHide":true,"title":true,"lineNumbers":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_-427547212","id":"20211022-174646_945712253","dateCreated":"2021-04-14T00:52:08+0000","dateStarted":"2021-09-30T17:06:33+0000","dateFinished":"2021-09-30T17:06:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:59"},{"text":"%sql\n","user":"MOVIESTREAM","dateUpdated":"2021-10-21T14:12:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1634924806093_-831978319","id":"20211022-174646_378920414","dateCreated":"2021-04-15T04:19:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:60"}],"name":"Workshop - Data Lake Accelerator","id":"1560393","noteParams":{},"noteForms":{},"angularObjects":{"ORA51EFB14B6D:MOVIESTREAM:1547111":[],"ORAEFE3947EDD:MOVIESTREAM:1547111":[],"ORAA37B448076:MOVIESTREAM:1547111":[],"MDW74C2D3B026:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}
